name: Manual website deployment

run-name: Trigger website deployment to GitHub Pages

on:
  workflow_dispatch:

permissions:
  actions: write
  contents: write

jobs:
  trigger-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      - name: Install dependencies
        run: npm install @actions/github

      - name: Call Deploy Workflow
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            try {
              const triggerUser = '${{ github.actor }}';

              const { Octokit } = require('@octokit/rest'); // Correct import
              const octokit = new Octokit({ auth: process.env.GITHUB_TOKEN }); // Initialize Octokit client

              const response = await octokit.actions.createWorkflowDispatch({
                owner: context.repo.owner,
                repo: context.repo.repo,
                workflow_id: 'deploy.yml',  // Ensure this matches your deploy workflow filename
                ref: 'website',  // The branch you want to trigger the workflow on
                inputs: {
                  triggerUser: triggerUser,
                },
              });

              console.log(response);
            } catch (error) {
              console.error('Error:', error);
              throw error;
            }
